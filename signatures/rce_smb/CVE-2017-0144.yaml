metadata:
  cve_ids:
    - CVE-2017-0144
  name: EternalBlue
  aliases:
    - MS17-010
  severity: critical
  description: >-
    SMB1 vulnerability exploited by EternalBlue affecting Windows systems that allows
    remote code execution through malformed SMB packets.
heuristic:
  required_signals: 1
  base_weight: 45
  risk_band: high
  conditions:
    - signal: smb1_possible
      expectation: true
      rationale: Vulnerability requires SMB1 dialects.
  boosters:
    - signal: anonymous_access
      description: Anonymous access enabled increases exploit risk.
      weight: 10
    - signal: host.admin_shares_accessible
      description: Admin shares accessible increases exploit impact.
      weight: 15
  verdict_mapping:
    confirmed_when:
      - condition: "ms17_010_status == 0xC0000205"
    likely_when:
      - condition: "smb1_possible == true"
    not_assessable_when:
      - condition: "smb1_possible == false"
        reason: "SMB1 not enabled; cannot perform safe FID0 check"
telemetry:
  existing_sources:
    - smb_negotiation
    - access_runner
  needed_enhancements:
    - ms17_010_check
references:
  - label: Microsoft Security Bulletin MS17-010
    url: https://docs.microsoft.com/en-us/security-updates/securitybulletins/2017/ms17-010
  - label: MITRE CVE
    url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-0144
notes:
  remediation_summary: Apply MS17-010 patch and disable SMB1 entirely.
  reporting_tip: Highlight high severity due to wormable nature and public exploit availability.
