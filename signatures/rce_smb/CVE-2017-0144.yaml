metadata:
  cve_ids:
    - CVE-2017-0144
  name: EternalBlue
  aliases:
    - MS17-010
  severity: high
  description: >-
    SMB1 vulnerability exploited by EternalBlue affecting Windows systems that allows
    remote code execution through malformed SMB packets.
heuristic:
  required_signals: 2
  base_weight: 45
  risk_band: high
  conditions:
    - signal: smb.negotiation.supports_smb1
      expectation: true
      rationale: Vulnerability requires SMB1 dialects.
    - signal: host.ms17_010_status
      expectation: missing
      rationale: Host lacks MS17-010 patch.
  boosters:
    - description: Anonymous access enabled increases exploit risk.
      weight: 10
    - description: Host accessible on public internet.
      weight: 15
telemetry:
  existing_sources:
    - smb_negotiation
    - access_runner
  needed_enhancements:
    - ms17_010_check
references:
  - label: Microsoft Security Bulletin MS17-010
    url: https://docs.microsoft.com/en-us/security-updates/securitybulletins/2017/ms17-010
  - label: MITRE CVE
    url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-0144
notes:
  remediation_summary: Apply MS17-010 patch and disable SMB1 entirely.
  reporting_tip: Highlight high severity due to wormable nature and public exploit availability.