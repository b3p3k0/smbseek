metadata:
  cve_ids:
    - CVE-2020-0796
  name: SMBGhost
  aliases:
    - SMBv3 Compression RCE
  severity: critical
  description: >-
    Heap overflow in SMB 3.1.1 compression (Windows 10/Server 2019) enabling unauthenticated RCE
    when compression is enabled and March 2020 patches are absent.
heuristic:
  required_signals: 2
  base_weight: 35
  risk_band: high
  conditions:
    - signal
      expectation: true
      rationale: Vulnerability targets SMB 3.1.1 dialect.
    - signal
      expectation: true
      rationale: Compression capability must be advertised.
  boosters:
    - description
      weight: 10
    - description
      weight: 5
telemetry:
  existing_sources:
    - smb_negotiation
    - shodan_metadata
  needed_enhancements:
    - hotfix_inventory
references:
  - label
    url: https://msrc.microsoft.com/update-guide/vulnerability/CVE-2020-0796
  - label
    url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-0796
notes:
  remediation_summary: Apply KB4551762 or later cumulative updates; disable SMB compression if immediate patching is impossible.
  reporting_tip: Mention if compression is disabledâ€”indicates compensating control already in place.
