metadata:
  cve_ids:
    - CVE-2020-0796
  name: SMBGhost
  aliases:
    - SMBv3 Compression RCE
  severity: critical
  description: >-
    Heap overflow in SMB 3.1.1 compression (Windows 10/Server 2019) enabling unauthenticated RCE
    when compression is enabled and March 2020 patches are absent.
heuristic:
  required_signals: 2
  base_weight: 35
  risk_band: high
  conditions:
    - signal: smb.negotiation.supports_smb3
      expectation: true
      rationale: SMBGhost requires SMB 3.1.1 negotiation contexts.
    - signal: host.os_detection
      expectation: windows 10
      rationale: Windows 10 workstations dominate the remaining SMBGhost surface area.
    - signal: host.os_detection
      expectation: windows server 2019
      rationale: Server 2019 inherits the same vulnerable SMB3 implementation.
  boosters:
    - description: Anonymous or guest access combined with SMB3 greatly increases exposure.
      weight: 10
    - description: Host observed directly on public networks (e.g., via Shodan) amplifies risk.
      weight: 5
telemetry:
  existing_sources:
    - smb_negotiation
    - shodan_metadata
  needed_enhancements:
    - hotfix_inventory
references:
  - label: Microsoft Security Response Center (CVE-2020-0796)
    url: https://msrc.microsoft.com/update-guide/vulnerability/CVE-2020-0796
  - label: MITRE CVE entry
    url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-0796
notes:
  remediation_summary: Apply KB4551762 or later cumulative updates; disable SMB compression if immediate patching is impossible.
  reporting_tip: Mention if compression is disabledâ€”indicates compensating control already in place.
