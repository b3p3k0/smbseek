metadata:
  cve_ids:
    - CVE-2021-34527
  name: PrintNightmare
  aliases:
    - Windows Print Spooler RCE
  severity: high
  description: >-
    Remote code execution in the Windows Print Spooler service that can be triggered after an attacker
    gains SMB access to stage malicious drivers or DLLs.
heuristic:
  required_signals: 2
  base_weight: 25
  risk_band: medium
  conditions:
    - signal
      expectation: \\PIPE\\spoolss
      rationale: Spooler RPC endpoint reachable from current probe context.
    - signal
      expectation: ["Windows Server", "Windows 10"]
      rationale: Vulnerable platforms hosting the spooler service.
  boosters:
    - description
      weight: 8
    - description
      weight: 5
telemetry:
  existing_sources:
    - probe_runner
    - access_runner
  needed_enhancements:
    - spooler_version_sampling
references:
  - label
    url: https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-34527
  - label
    url: https://kb.cert.org/vuls/id/383432
notes:
  remediation_summary: Apply latest cumulative updates and disable Point and Print or restrict driver installation to admins.
  reporting_tip: Recommend disabling the spooler on servers that do not require printing services.
