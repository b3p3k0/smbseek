metadata:
  cve_ids:
    - CVE-2020-1206
  name: SMBleed
  aliases:
    - SMBGhost companion infoleak
  severity: high
  description: >-
    Information disclosure in SMB compression credits that, when combined with SMBGhost,
    enables reliable RCE against Windows 10/Server 2019 systems.
heuristic:
  required_signals: 2
  base_weight: 25
  risk_band: medium
  conditions:
    - signal: smb.negotiation.supports_smb3
      expectation: true
      rationale: SMBleed relies on SMB 3.1.1 compression logic.
    - signal: host.os_detection
      expectation: windows 10
      rationale: Windows 10 builds prior to June 2020 remain exposed.
    - signal: host.os_detection
      expectation: windows server 2019
      rationale: Server 2019 inherits the same vulnerable SMB3 code path.
  boosters:
    - description: Host also matches SMBGhost heuristic, enabling the critical combo.
      weight: 10
    - description: Anonymous or guest access makes staging the leak trivial.
      weight: 5
telemetry:
  existing_sources:
    - smb_negotiation
    - rce_scanner
  needed_enhancements:
    - credit_observer
references:
  - label: Microsoft Security Response Center (CVE-2020-1206)
    url: https://msrc.microsoft.com/update-guide/vulnerability/CVE-2020-1206
  - label: ZecOps SMBleed analysis
    url: https://blog.zecops.com/vulnerabilities/introducing-smbleed-new-critical-vulnerability-affecting-smb/
notes:
  remediation_summary: Install June 2020 cumulative updates or disable SMB compression temporarily.
  reporting_tip: Emphasize when SMBGhost + SMBleed fire togetherâ€”analysts should treat as critical combo.
